<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>statuses</title>
</head>
<body>
    <h1 class="text-center mt-2">Statuses</h1>
    <div class="col-xl-3 col-lg-6 text-center ms-3 mb-2">
      <div class="card l-bg-blue-dark">
          <div class="card-statistic-3 p-4">
              <div class="card-icon card-icon-large"><i class="fa fa-list"></i></div>
                 <div class="mb-4">
                    <h5 class="card-title mb-0">Total Status</h5>
                  </div>
                  <div class="row align-items-center mb-2 d-flex">
                    <div class="col-8">
                       <h3 class="d-flex align-items-center mb-0">
                          <%= pluralize(@statuses.count, "status") %>
                       </h3>
                    </div>
                </div>
            </div>
       </div>
   </div>  
    <div class="flickr_pagination">
      <%= will_paginate @statuses, :container => false %>
    </div>
    <% @statuses.each do |status| %>
      <% if status.tasks.any? %>
    <div class="card-body">
       <div class="card-header text-center fw-bold">
          Date: <%= status.date.strftime("%d/%m/%Y") %>
       </div>
        <table class="table">
            <thead>
              <tr>
                <th scope="col">#</th>
                <th scope="col">Task name</th>
                <th scope="col">Git PR</th>
                <th scope="col">Hour</th>
              </tr>
            </thead>
            <tbody>
                <% status.tasks.each.with_index(1) do |task,index| %>
                    <tr>
                      <th scope="row"><%= index %></th>
                      <td><%= task.task_name %></td>
                      <td><%= link_to "Github PR", task.git_pr_link, target: '_blank' %></td>
                      <td><%= task.hour %></td>
                    </tr>
                <% end %>
            </tbody>
          </table>
    </div>
    <div class="card-footer text-center fw-bold ms-3 me-3">
       Total hour(s) : <%= pluralize(status.total_hours_count, "hour")%>
       <div class="text-center">
         <%= link_to "Edit", edit_status_path(status),class:"me-2"%>
         <%= link_to "Delete", status_path(status), method: :delete, data: { confirm: "Are you sure ?" }%>
       </div>
    </div>
<% end %>
<% end %>
<div class="flickr_pagination mt-3">
  <%= will_paginate @statuses, :container => false %>
</div>
</body>
<%= render 'layouts/footer'%>
</html>